# Tomographic migration velocity model building using depth-migrated common image gathers

## Introduction

<p></p>
Prestack depth migration has been routinely applied to identify potential targets for oil and gas exploration. Accurate knowledge of migration velocity is crucial for producing high-fidelity subsurface images. Tomographic migration velocity model building is designed to reconstruct the velocity model for prestack depth migration. The objective of this project is to estimate the migration velocity model that removes the residual errors of primary reflection events in the depth-migrated common image gathers, and works with prestack depth migration iteratively to achieve the high quality imaging of complex geologic structures.

## Workflow for velocity model building
<p align="center">
 <img src="https://user-images.githubusercontent.com/110936252/186238079-a8b7ee63-bfb2-42ed-bba5-529197f72362.png" alt="Figure 1" width="600"/>
</p>

## Ray-based velocity model building
The data are offset common image gathers generated by Kirchhoff depth migration. Fréchet derivatives are calculated by dynamic ray tracing. A conjugate gradient method with constraints is used to solve the linear least square problem.

<p align="center">
 <img src="https://user-images.githubusercontent.com/110936252/186250741-275affdb-1041-45d4-9a1b-7ca7f86579c7.png" alt="Figure 2" width="550"/>
</p>

## Sensitivity kernel-based velocity model building
The data are shot-indexed or angle-domain common image gathers generated by reverse time depth migration. Fréchet derivatives are calculated by sensitivity kernel. A conjugate gradient method with constraints is used to solve the linear least square problem. The calculation of 3D sensitivity kernel can be accelerated by applying the variable grid scheme. The sensitivity kernel-based velocity model building can better update migration velocity in complex media and is a wave equation based approach that is suitable and robust for reverse time migaration.

<p align="center">
 <img src="https://user-images.githubusercontent.com/110936252/186256802-7e001c5e-9f47-4e60-9a2f-e676aa3af981.png" alt="Figure 3" width="700"/>
</p>

## Salt model building example
The method is tested through a salt model building example on the synthetic data of a 2D Sigsbee2 model. As expected, this method
produces a high-fidelity subsurface image and provides a velocity model that is much closer to the true model.

<p align="center">
 <img src="https://user-images.githubusercontent.com/110936252/186258661-e97731cd-c4ac-4cad-853c-1475cfa2a8bd.png" alt="Figure 4" width="600"/>
 <img src="https://user-images.githubusercontent.com/110936252/186258830-270fb316-a182-4d79-b685-8672a80c69ae.png" alt="Figure 5" width="600"/>
 <img src="https://user-images.githubusercontent.com/110936252/186259002-c1160b6d-4a5b-44f9-bd02-e5bc2c988394.png" alt="Figure 6" width="600"/>
</p>

## References
<p>Xia, F., Ren, Y., and Jin, S., 2006, Residual migration-velocity analysis using common angle image gathers: 76th Annual International Meeting, SEG, Expanded Abstracts, 2455-2459.<p/>
<p>Xia, F., Ren, Y., and Jin, S., 2008, Tomographic migration-velocity analysis using common angle image gathers: 78th Annual International Meeting, SEG, Expanded Abstracts, 3103-3107.<p/>
<p>Xia, F., Jin, S., and Pajchel, J., 2013, Angle-domain wave equation tomography using RTM image gathers: 83rd Annual International Meeting, SEG, Expanded Abstracts, 4822-4826.<p/>
<p>Xia, F., Ren, Y., and Jin, S., 2013, Seismic imaging systems and methods employing tomographic migration velocity analysis using common angle image gathers, U.S. Patent 8,406,081.<p/>
<p>Jin, S., Xu, S., Xia, F., Ottolini, R., and Ren, Y., 2014, Structure tensor constrained tomographic migration velocity analysis. 84th Annual International Meeting, SEG, Expanded Abstracts, 4702-4706.<p/>
<p>Xia, F., Ren, Y., and Jin, S., 2014, Sensitivity kernel-based migration velocity analysis in 3D anisotropic media, U.S Patent 8,830,788.<p/>
<p>Xia, F., Jin, S., and Pajchel, J., 2015, Sensitivity kernel-based tomographic migration velocity analysis using RTM angle image gathers, Geophysics, 80(3), U25-U34.<p/>
<p>Xia, F., 2016 Sensitivity kernel-based tomography using RTM angle image gathers in VTI media: 86th Annual International Meeting, SEG, Expanded Abstracts, 5302-5306.<p/>
<p>Xia, F., 2016, Semblance-based anisotropy parameter estimation using isotropic depth-migrated common image gathers: 86th Annual International Meeting, SEG, Expanded Abstracts, 285-290.<p/>
<p>Xia, F., 2021, Estimating interval anisotropy parameter for pre-stack depth migration using a least-squares method, U.S Patent 10,908,309.<br/>
<p>Xia, F., and Jin, S., 2021, Semblance-based anisotropy parameter estimation using isotropic depth-migrated common image gathers, U.S Patent 10,942,287.<br/>
<p>Xia, F., 2022, Method and system that uses an anisotropy parameter to generate high-resolution time-migrated image gathers for reservoir characterization, and interpretation, U.S Patent 11,320,554.<br/>
